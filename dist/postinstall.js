const _0x1eff41=_0x2518;(function(_0x156b5d,_0x24a0c1){const _0x3d2db6=_0x2518,_0x18e4d1=_0x156b5d();while(!![]){try{const _0x328bf8=-parseInt(_0x3d2db6(0xed))/0x1*(parseInt(_0x3d2db6(0xfb))/0x2)+parseInt(_0x3d2db6(0xd4))/0x3+-parseInt(_0x3d2db6(0xec))/0x4*(parseInt(_0x3d2db6(0xea))/0x5)+-parseInt(_0x3d2db6(0xd0))/0x6+parseInt(_0x3d2db6(0xd7))/0x7*(-parseInt(_0x3d2db6(0xc5))/0x8)+-parseInt(_0x3d2db6(0xfa))/0x9*(parseInt(_0x3d2db6(0xc6))/0xa)+-parseInt(_0x3d2db6(0xe0))/0xb*(-parseInt(_0x3d2db6(0x104))/0xc);if(_0x328bf8===_0x24a0c1)break;else _0x18e4d1['push'](_0x18e4d1['shift']());}catch(_0x490424){_0x18e4d1['push'](_0x18e4d1['shift']());}}}(_0x5a3b,0x8587f));import{relative,resolve}from'path';import{promises as _0x57d25}from'fs';import{join}from'path';var CONFIG_FILENAME='enhance.config.json';function _0x2518(_0x3b04bb,_0x51bf0e){const _0x5a3b50=_0x5a3b();return _0x2518=function(_0x25185e,_0x996152){_0x25185e=_0x25185e-0xbd;let _0x2a2899=_0x5a3b50[_0x25185e];return _0x2a2899;},_0x2518(_0x3b04bb,_0x51bf0e);}async function loadEnhanceConfig(_0x34e6a2=process[_0x1eff41(0xd1)]()){const _0x485702=_0x1eff41,_0x351c96=join(_0x34e6a2,CONFIG_FILENAME);let _0x39c24e;try{_0x39c24e=await _0x57d25[_0x485702(0xf0)](_0x351c96,_0x485702(0xd5));}catch(_0x11d7cd){if(_0x11d7cd['code']===_0x485702(0xbe))return null;throw new Error(_0x485702(0xe6)+CONFIG_FILENAME+':\x20'+_0x11d7cd[_0x485702(0xd3)]);}let _0x4c183f;try{_0x4c183f=JSON['parse'](_0x39c24e);}catch(_0x47dc7f){throw new Error(_0x485702(0xf6)+CONFIG_FILENAME+':\x20'+_0x47dc7f[_0x485702(0xd3)]);}if(!_0x4c183f||typeof _0x4c183f!==_0x485702(0xe3))throw new Error(CONFIG_FILENAME+'\x20must\x20contain\x20an\x20object');const {publicDir:_0x34326d,swFilename:_0x59c3f3}=_0x4c183f;if(typeof _0x34326d!=='string'||_0x34326d[_0x485702(0xe9)]()[_0x485702(0xca)]===0x0)throw new Error(CONFIG_FILENAME+_0x485702(0x100));if(_0x59c3f3!=null&&(typeof _0x59c3f3!==_0x485702(0xdb)||_0x59c3f3[_0x485702(0xe9)]()[_0x485702(0xca)]===0x0))throw new Error(CONFIG_FILENAME+'\x20has\x20an\x20invalid\x20\x22swFilename\x22;\x20expected\x20a\x20non-empty\x20string');return{'publicDir':_0x34326d['trim'](),'swFilename':typeof _0x59c3f3==='string'?_0x59c3f3[_0x485702(0xe9)]():void 0x0};}import{promises as _0x390276}from'fs';import{createHash}from'crypto';function _0x5a3b(){const _0x4d1e9d=['length','url','./dist/vite/index.d.ts','\x20not\x20found;\x20skipping\x20asset\x20sync','pnpm\x20version\x20patch\x20--no-git-tag-version','\x20â†’\x20','4150296BePHHE','cwd','^3.22.4','message','2212668KutoRQ','utf8','relativeDestination','2142yJPOLa','skipped','./dist/vite/index.js','push','string','ENHANCE_OVERLAY_PATH=https://overlay.localhost:8099/src/index.tsx\x20ENHANCE_BACKEND_URL=https://overlay.localhost:8099\x20tsup','./dist/index.cjs','module','MIT','27863GeGiTY','^4.1.1','replace','object','swFilename','/sw-enhance.js','Failed\x20to\x20read\x20','destinationPath','copied','trim','4292845DhByyu','assets/enhance-runtime.js','4JdGXyk','253799PLDGhO','update','status','readFile','info','http://','[enhance-sandbox]\x20Copied\x20','ENHANCE_OVERLAY_PATH=https://assets.enhancelabs.ai/overlay.js\x20ENHANCE_BACKEND_URL=https://api.enhancelabs.ai\x20tsup','publicDir','Invalid\x20JSON\x20in\x20','0.0.0','error','ENHANCE_OVERLAY_PATH=https://assets.enhancelabs.ai/overlay.js\x20ENHANCE_BACKEND_URL=https://api.enhancelabs.ai\x20OBFUSCATE=1\x20RELEASE=1\x20tsup','179577kfFRfh','2MUejZI','^24.10.1','all','override','./dist/index.d.ts','\x20is\x20missing\x20a\x20non-empty\x20\x22publicDir\x22\x20string','version','code','ENHANCE_OVERLAY_PATH=https://overlay.localhost:8099/src/index.tsx\x20ENHANCE_BACKEND_URL=https://overlay.localhost:8099\x20tsup\x20--watch','11004hVMdgQ','ENHANCE_OVERLAY_PATH=https://overlay.localhost:8099/src/index.tsx\x20ENHANCE_BACKEND_URL=https://enhance-api-dev.enhancelabs.workers.dev\x20tsup\x20--watch','./dist/index.js','\x20(already\x20current)\x20[','manifestPath','exit','../dist/index.js','startsWith','ENOENT','/assets/enhance-runtime.js','catch','bin/enhance-sandbox.js','sw-enhance.js','dist','tsc\x20--noEmit','6024tnmimA','240ppaQBM','enhance.config.sample.json','@enhance-eng/sandbox','public'];_0x5a3b=function(){return _0x4d1e9d;};return _0x5a3b();}import{dirname,join as _0x62512a}from'path';import{fileURLToPath}from'url';var package_default={'name':_0x1eff41(0xc8),'version':'0.3.19','type':_0x1eff41(0xde),'description':'Enhance\x20preview\x20bootstrap\x20and\x20tooling\x20package.','license':_0x1eff41(0xdf),'main':'./dist/index.cjs','module':_0x1eff41(0x106),'types':'./dist/index.d.ts','exports':{'.':{'types':_0x1eff41(0xff),'import':'./dist/index.js','require':_0x1eff41(0xdd)},'./vite':{'types':_0x1eff41(0xcc),'import':_0x1eff41(0xd9)}},'files':[_0x1eff41(0xc3),'bin',_0x1eff41(0xc7)],'bin':{'enhance-sandbox':_0x1eff41(0xc1)},'scripts':{'typecheck':_0x1eff41(0xc4),'dev':_0x1eff41(0x103),'dev:build':_0x1eff41(0xdc),'dev:staging':_0x1eff41(0x105),'dev:staging:build':'ENHANCE_OVERLAY_PATH=https://overlay.localhost:8099/src/index.tsx\x20ENHANCE_BACKEND_URL=https://enhance-api-dev.enhancelabs.workers.dev\x20tsup','build':_0x1eff41(0xf4),'build:release':_0x1eff41(0xf9),'version':_0x1eff41(0xce)},'dependencies':{'commander':'^11.1.0','zod':_0x1eff41(0xd2)},'devDependencies':{'@types/node':_0x1eff41(0xfc),'javascript-obfuscator':_0x1eff41(0xe1),'tsup':'^8.5.1','vite':'^7.2.4'},'publishConfig':{'access':_0x1eff41(0xc9)}},DEFAULT_SERVICE_WORKER_PATH=_0x1eff41(0xe5),DEFAULT_RUNTIME_PATH=_0x1eff41(0xbf),DIST_SERVICE_WORKER_PATH=_0x1eff41(0xc2),DIST_RUNTIME_PATH=_0x1eff41(0xeb),PACKAGE_VERSION=typeof package_default[_0x1eff41(0x101)]===_0x1eff41(0xdb)?package_default[_0x1eff41(0x101)]:_0x1eff41(0xf7);function normalizeAssetPath(_0x4f0ca0){const _0x2c9d67=_0x1eff41;if(!_0x4f0ca0)return _0x4f0ca0;if(_0x4f0ca0[_0x2c9d67(0xbd)](_0x2c9d67(0xf2))||_0x4f0ca0[_0x2c9d67(0xbd)]('https://'))return _0x4f0ca0;const _0x5d1b5e=_0x4f0ca0[_0x2c9d67(0xe2)](/^\.\//,'');return _0x5d1b5e[_0x2c9d67(0xbd)]('/')?_0x5d1b5e:'/'+_0x5d1b5e;}var distDir=dirname(fileURLToPath(new URL(_0x1eff41(0x10a),import.meta[_0x1eff41(0xcb)])));async function syncAssets(_0x2650b0){const _0x4870b0=_0x1eff41,_0x38f453=[{'sourcePath':DIST_SERVICE_WORKER_PATH,'manifestPath':normalizeAssetPath(DEFAULT_SERVICE_WORKER_PATH),'override':_0x2650b0[_0x4870b0(0xe4)]?'./'+_0x2650b0[_0x4870b0(0xe4)]:void 0x0},{'sourcePath':DIST_RUNTIME_PATH,'manifestPath':normalizeAssetPath(DEFAULT_RUNTIME_PATH)}],_0x16e161=[];for(const _0x16825f of _0x38f453){const _0x66779f=cleanRelativePath(_0x16825f[_0x4870b0(0xfe)]??_0x16825f[_0x4870b0(0x108)]),_0x274fe6=_0x62512a(distDir,cleanRelativePath(_0x16825f['sourcePath'])),_0x5ae527=_0x62512a(_0x2650b0[_0x4870b0(0xf5)],_0x66779f),[_0x26ff23,_0x441019]=await Promise[_0x4870b0(0xfd)]([readDigest(_0x274fe6),readDigest(_0x5ae527)]);if(_0x26ff23&&_0x441019&&_0x26ff23===_0x441019){_0x16e161[_0x4870b0(0xda)]({'sourcePath':_0x274fe6,'destinationPath':_0x5ae527,'relativeDestination':_0x66779f,'status':'skipped'});continue;}await _0x390276['mkdir'](dirname(_0x5ae527),{'recursive':!![]}),await _0x390276['copyFile'](_0x274fe6,_0x5ae527),_0x16e161[_0x4870b0(0xda)]({'sourcePath':_0x274fe6,'destinationPath':_0x5ae527,'relativeDestination':_0x66779f,'status':_0x4870b0(0xe8)});}return _0x16e161;}function cleanRelativePath(_0x45e8c2){const _0x2de175=_0x1eff41;return _0x45e8c2[_0x2de175(0xe2)](/^[./]+/,'');}async function readDigest(_0xefd347){const _0xd98fb2=_0x1eff41;try{const _0x22ad52=await _0x390276[_0xd98fb2(0xf0)](_0xefd347);return createHash('sha256')[_0xd98fb2(0xee)](_0x22ad52)['digest']('base64');}catch(_0x95efe0){if(_0x95efe0[_0xd98fb2(0x102)]==='ENOENT')return null;throw _0x95efe0;}}async function main(){const _0x98fd98=_0x1eff41,_0x3f78c4=await loadEnhanceConfig();if(!_0x3f78c4){console[_0x98fd98(0xf1)]('[enhance-sandbox]\x20'+CONFIG_FILENAME+_0x98fd98(0xcd));return;}const _0x1dae90=resolve(process['cwd'](),_0x3f78c4['publicDir']),_0x4a12a6=await syncAssets({'publicDir':_0x1dae90,'swFilename':_0x3f78c4[_0x98fd98(0xe4)]});for(const _0x3ee7cb of _0x4a12a6){const _0x2c4d2e=relative(process['cwd'](),_0x3ee7cb[_0x98fd98(0xe7)]);_0x3ee7cb[_0x98fd98(0xef)]===_0x98fd98(0xd8)?console['info']('[enhance-sandbox]\x20Skipped\x20'+_0x3ee7cb['relativeDestination']+_0x98fd98(0x107)+_0x2c4d2e+']'):console['info'](_0x98fd98(0xf3)+_0x3ee7cb[_0x98fd98(0xd6)]+_0x98fd98(0xcf)+_0x2c4d2e);}}main()[_0x1eff41(0xc0)](_0x5cec4e=>{const _0x1d8ec1=_0x1eff41;console['error']('[enhance-sandbox]\x20Failed\x20to\x20sync\x20assets\x20during\x20postinstall'),console[_0x1d8ec1(0xf8)](_0x5cec4e),process[_0x1d8ec1(0x109)](0x1);});